2017-02-17 12:18:38,391-0200 INFO  Loader JAVA Oracle Corporation Java HotSpot(TM) 64-Bit Server VM 1.7.0_80
2017-02-17 12:18:38,393-0200 INFO  Loader VERSION Swift trunk git-rev: 18aec82244c5611381528bc361888c553570c66e heads/master 6574
2017-02-17 12:18:38,393-0200 INFO  Loader RUN_ID run005
2017-02-17 12:18:38,393-0200 INFO  Loader ARGUMENTS [-runid, run005, -logfile, /home/mondelli/Dropbox/Docker/swift_verao/pagerank/run005/swift.log, pagerank.swift, -word=Brazil]
2017-02-17 12:18:38,393-0200 INFO  Loader MAX_HEAP 954728448
2017-02-17 12:18:38,393-0200 INFO  Loader GLOBUS_HOSTNAME mondelli-520U4C
2017-02-17 12:18:38,393-0200 INFO  Loader CWD /home/mondelli/Dropbox/Docker/swift_verao/pagerank/.
2017-02-17 12:18:38,395-0200 DEBUG Loader SWIFT_CONFIGURATION 
[D] /home/mondelli/swift-k/dist/swift-svn/etc/swift.conf
[C] <Command Line>
{
	TCPPortRange: "50000, 50100"                               # [D] line 27
	alwaysTransferWrapperLog: true                             # [D] line 61
	executionRetries: 0                                        # [D] line 137
	fileOperationsThrottle: 8                                  # [D] line 121
	fileTransfersThrottle: 4                                   # [D] line 107
	hostJobSubmitThrottle: 2                                   # [D] line 95
	jobSubmitThrottle: 4                                       # [D] line 83
	keepSiteDir: false                                         # [D] line 131
	lazyErrors: true                                           # [D] line 41
	logProvenance: false                                       # [D] line 200
	maxForeachThreads: 16384                                   # [D] line 194
	replicationEnabled: false                                  # [D] line 146
	replicationLimit: 3                                        # [D] line 157
	replicationMinQueueTime: 60                                # [D] line 153
	site.local {
		app.ALL.executable: "*"                                   # [D] line 235
		execution.type: "local"                                   # [D] line 223
		filesystem.type: "local"                                  # [D] line 226
		initialParallelTasks: 8                                   # [D] line 230
		maxParallelTasks: 16                                      # [D] line 229
		workDirectory: "swiftwork"                                # [D] line 232
	}
	sites: [local]                                             # [D] line 239
	tracingEnabled: false                                      # [D] line 51
}

2017-02-17 12:18:38,396-0200 DEBUG textfiles BEGIN SWIFTSCRIPT:
type file; 

#USE: swift pagerank.swift -word=Brazil

string w = arg("word");

file text[] <filesys_mapper; location="./raw.en3", prefix="english">;
file select[] <simple_mapper; location="./select", prefix="select", suffix=".txt">;
file count[] <simple_mapper; location="./count", prefix="count_word", suffix=".txt">;
file group <"group.txt">;
file sort <"sort.txt">;

app (file o) select_word (file i, string word)
{
	grep "-o" "-w" word filename(i) stdout=filename(o);
}

app (file o) count_word (file i)
{
	wc "-w" filename(i) stdout=filename(o);
}

app (file o) group_count (file i[])
{
	cat filenames(i) stdout=filename(o);
}

app (file o) sort (file i)
{
	sort "-n" filename(i) stdout=filename(o);
}

foreach t,i in text
{
	select[i] = select_word(t);
	count[i] = count_word(select[i]);
	
}

group = group_count(count);
sort = sort(group);



2017-02-17 12:18:38,396-0200 DEBUG textfiles END SWIFTSCRIPT:
2017-02-17 12:18:38,396-0200 INFO  Loader pagerank.swift: source file is new. Recompiling.
2017-02-17 12:18:38,780-0200 DEBUG Loader Detailed exception:
org.griphyn.vdl.karajan.CompilationException: Compile error in foreach statement at 33
	at org.griphyn.vdl.engine.Karajan.foreachStat(Karajan.java:1030)
	at org.griphyn.vdl.engine.Karajan.statement(Karajan.java:720)
	at org.griphyn.vdl.engine.Karajan.statements(Karajan.java:705)
	at org.griphyn.vdl.engine.Karajan.program(Karajan.java:363)
	at org.griphyn.vdl.engine.Karajan.compile(Karajan.java:131)
	at org.griphyn.vdl.karajan.Loader.compile(Loader.java:491)
	at org.griphyn.vdl.karajan.Loader.main(Loader.java:196)
Caused by: org.griphyn.vdl.karajan.CompilationException: Compile error in assignment at 35: Compile error in procedure invocation at 35
	at org.griphyn.vdl.engine.Karajan.assign(Karajan.java:629)
	at org.griphyn.vdl.engine.Karajan.statement(Karajan.java:711)
	at org.griphyn.vdl.engine.Karajan.statements(Karajan.java:705)
	at org.griphyn.vdl.engine.Karajan.foreachStat(Karajan.java:1021)
	... 6 more
Caused by: org.griphyn.vdl.karajan.CompilationException: Compile error in procedure invocation at 35
	at org.griphyn.vdl.engine.Karajan.call(Karajan.java:818)
	at org.griphyn.vdl.engine.Karajan.assign(Karajan.java:601)
	... 9 more
Caused by: org.griphyn.vdl.karajan.CompilationException: Parameter type mismatch: (file) select_word(file)
	Expected: (file) select_word(file, string)
	at org.griphyn.vdl.engine.Karajan.noFunctionOrProcedure(Karajan.java:891)
	at org.griphyn.vdl.engine.Karajan.call(Karajan.java:802)
	... 10 more
